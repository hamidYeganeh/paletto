<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Users Module Demo</title>
    <style>
      :root {
        color-scheme: light dark;
        font-family:
          "SF Pro Text",
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          sans-serif;
        background:
          radial-gradient(120% 120% at 15% 20%, #1c2733 0, #0e1116 35%),
          radial-gradient(120% 120% at 85% 10%, #2a1f3d 0, #0e1116 35%),
          radial-gradient(140% 140% at 50% 120%, #0f1f2d 0, #0e1116 40%);
        color: #f4f7fb;
      }

      body {
        margin: 0;
        min-height: 100vh;
        display: grid;
        place-items: center;
        padding: 32px;
      }

      .grid {
        display: grid;
        gap: 18px;
        width: min(960px, 100%);
      }

      .card {
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.08);
        backdrop-filter: blur(10px);
        border-radius: 18px;
        padding: 24px;
        box-shadow: 0 18px 80px rgba(0, 0, 0, 0.35);
      }

      h1 {
        margin: 0 0 6px 0;
        letter-spacing: -0.02em;
        font-size: 28px;
      }

      h2 {
        margin: 0 0 6px 0;
        font-size: 18px;
      }

      p {
        margin: 0 0 18px 0;
        color: #c8d1dc;
      }

      form {
        display: grid;
        gap: 14px;
      }

      label {
        font-weight: 600;
        color: #e3e9f1;
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      input,
      textarea,
      select {
        padding: 12px 14px;
        border-radius: 10px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        background: rgba(0, 0, 0, 0.25);
        color: #f4f7fb;
        font-size: 15px;
        transition:
          border-color 0.2s ease,
          background 0.2s ease;
      }

      textarea {
        min-height: 90px;
        resize: vertical;
      }

      input:focus,
      textarea:focus,
      select:focus {
        outline: none;
        border-color: #7dd1ff;
        background: rgba(0, 0, 0, 0.35);
      }

      button {
        padding: 12px 15px;
        border: none;
        border-radius: 12px;
        font-weight: 700;
        letter-spacing: 0.01em;
        cursor: pointer;
        background: linear-gradient(120deg, #66e0ff, #7a7cff, #ff6b9d);
        color: #0b0f16;
        box-shadow: 0 12px 35px rgba(0, 0, 0, 0.4);
        transition:
          transform 0.2s ease,
          box-shadow 0.2s ease;
      }

      button:hover {
        transform: translateY(-1px);
        box-shadow: 0 14px 45px rgba(0, 0, 0, 0.45);
      }

      .muted {
        color: #a7b3c4;
        font-size: 14px;
      }

      .panel {
        margin-top: 12px;
        padding: 12px;
        border-radius: 12px;
        background: rgba(0, 0, 0, 0.35);
        border: 1px solid rgba(255, 255, 255, 0.07);
      }

      pre {
        margin: 0;
        white-space: pre-wrap;
        word-break: break-word;
        font-family: "SF Mono", "JetBrains Mono", Menlo, monospace;
        color: #dbe9ff;
      }

      .columns {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
        gap: 18px;
      }

      .actions {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
      }

      .actions button {
        flex: 1 1 auto;
      }
    </style>
  </head>
  <body>
    <section class="grid">
      <div class="card">
        <h1>Users Module Demo</h1>
        <p>
          Exercise authenticated endpoints:
          <code>GET /users/profile/get</code> and
          <code>PATCH /users/profile/update</code>. Admin endpoints
          <code>GET /admin/users/list</code> and
          <code>PATCH /admin/users/update</code> require an admin token (you can
          reuse the same token if it has admin role).
        </p>

        <form id="base-form">
          <label>
            API base URL
            <input
              id="base-url"
              name="baseUrl"
              type="url"
              value="http://localhost:5000"
              autocomplete="off"
              required
            />
          </label>
          <label>
            Bearer token
            <input
              id="token"
              name="token"
              type="text"
              placeholder="Paste token from /auth/sign-in"
              autocomplete="off"
              required
            />
            <span class="muted"
              >You can sign in using <code>auth-demo.html</code> to get a
              token.</span
            >
          </label>
        </form>
      </div>

      <div class="columns">
        <div class="card">
          <h2>Get profile</h2>
          <p class="muted">GET /users/profile/get</p>
          <button id="get-profile">Fetch profile</button>
          <div class="panel">
            <div class="muted">Curl</div>
            <pre id="curl-get"></pre>
          </div>
          <div class="panel">
            <div class="muted">Response</div>
            <pre id="resp-get">Waiting...</pre>
          </div>
        </div>

        <div class="card">
          <h2>Update profile</h2>
          <p class="muted">PATCH /users/profile/update</p>
          <form id="update-form">
            <label>
              Name
              <input
                id="name"
                name="name"
                type="text"
                placeholder="Jane Doe"
              />
            </label>
            <label>
              Bio
              <textarea
                id="bio"
                name="bio"
                placeholder="Something about you (optional)"
              ></textarea>
            </label>
            <button type="submit">Update profile</button>
          </form>
          <div class="panel">
            <div class="muted">Curl</div>
            <pre id="curl-update"></pre>
          </div>
          <div class="panel">
            <div class="muted">Response</div>
            <pre id="resp-update">Waiting...</pre>
          </div>
        </div>

        <div class="card">
          <h2>Create artist profile</h2>
          <p class="muted">POST /artists/create</p>
          <form id="artist-create-form">
            <label>
              Display name
              <input
                id="artist-display-name"
                name="displayName"
                type="text"
                placeholder="Painter Jane"
              />
            </label>
            <label>
              Techniques (comma-separated ObjectIds)
              <input
                id="artist-techniques"
                name="techniques"
                type="text"
                placeholder="6512abc..., 6512def..."
              />
            </label>
            <label>
              Styles (comma-separated ObjectIds)
              <input
                id="artist-styles"
                name="styles"
                type="text"
                placeholder="6512fed..., 6512cba..."
              />
            </label>
            <button type="submit">Create artist</button>
          </form>
          <div class="panel">
            <div class="muted">Curl</div>
            <pre id="curl-artist-create"></pre>
          </div>
          <div class="panel">
            <div class="muted">Response</div>
            <pre id="resp-artist-create">Waiting...</pre>
          </div>
        </div>

        <div class="card">
          <h2>Update artist profile</h2>
          <p class="muted">PATCH /artists/update</p>
          <form id="artist-update-form">
            <label>
              Display name
              <input
                id="artist-update-display-name"
                name="displayName"
                type="text"
                placeholder="Painter Jane"
              />
            </label>
            <label>
              Techniques (comma-separated ObjectIds)
              <input
                id="artist-update-techniques"
                name="techniques"
                type="text"
                placeholder="6512abc..., 6512def..."
              />
            </label>
            <label>
              Styles (comma-separated ObjectIds)
              <input
                id="artist-update-styles"
                name="styles"
                type="text"
                placeholder="6512fed..., 6512cba..."
              />
            </label>
            <button type="submit">Update artist</button>
          </form>
          <div class="panel">
            <div class="muted">Curl</div>
            <pre id="curl-artist-update"></pre>
          </div>
          <div class="panel">
            <div class="muted">Response</div>
            <pre id="resp-artist-update">Waiting...</pre>
          </div>
        </div>

        <div class="card">
          <h2>Saved artworks</h2>
          <p class="muted">
            POST/DELETE /users/profile/saved/artworks, GET
            /users/profile/saved/artworks
          </p>
          <form id="saved-artworks-form">
            <label>
              Artwork Id
              <input
                id="saved-artwork-id"
                name="artworkId"
                type="text"
                placeholder="artwork ObjectId"
              />
            </label>
            <div class="actions">
              <button type="button" id="save-artwork-btn">Save artwork</button>
              <button type="button" id="unsave-artwork-btn">
                Remove saved
              </button>
              <button type="button" id="list-saved-artworks-btn">
                List saved
              </button>
            </div>
          </form>
          <div class="panel">
            <div class="muted">Response</div>
            <pre id="resp-saved-artworks">Waiting...</pre>
          </div>
        </div>

        <div class="card">
          <h2>Saved blogs</h2>
          <p class="muted">
            POST/DELETE /users/profile/saved/blogs, GET /users/profile/saved/blogs
          </p>
          <form id="saved-blogs-form">
            <label>
              Blog Id
              <input
                id="saved-blog-id"
                name="blogId"
                type="text"
                placeholder="blog ObjectId"
              />
            </label>
            <div class="actions">
              <button type="button" id="save-blog-btn">Save blog</button>
              <button type="button" id="unsave-blog-btn">Remove saved</button>
              <button type="button" id="list-saved-blogs-btn">
                List saved
              </button>
            </div>
          </form>
          <div class="panel">
            <div class="muted">Response</div>
            <pre id="resp-saved-blogs">Waiting...</pre>
          </div>
        </div>

        <div class="card">
          <h2>Liked artworks</h2>
          <p class="muted">
            POST/DELETE /users/profile/liked/artworks, GET
            /users/profile/liked/artworks
          </p>
          <form id="liked-artworks-form">
            <label>
              Artwork Id
              <input
                id="liked-artwork-id"
                name="artworkId"
                type="text"
                placeholder="artwork ObjectId"
              />
            </label>
            <div class="actions">
              <button type="button" id="like-artwork-btn">Like artwork</button>
              <button type="button" id="unlike-artwork-btn">
                Remove like
              </button>
              <button type="button" id="list-liked-artworks-btn">
                List liked
              </button>
            </div>
          </form>
          <div class="panel">
            <div class="muted">Response</div>
            <pre id="resp-liked-artworks">Waiting...</pre>
          </div>
        </div>

        <div class="card">
          <h2>Liked blogs</h2>
          <p class="muted">
            POST/DELETE /users/profile/liked/blogs, GET /users/profile/liked/blogs
          </p>
          <form id="liked-blogs-form">
            <label>
              Blog Id
              <input
                id="liked-blog-id"
                name="blogId"
                type="text"
                placeholder="blog ObjectId"
              />
            </label>
            <div class="actions">
              <button type="button" id="like-blog-btn">Like blog</button>
              <button type="button" id="unlike-blog-btn">Remove like</button>
              <button type="button" id="list-liked-blogs-btn">List liked</button>
            </div>
          </form>
          <div class="panel">
            <div class="muted">Response</div>
            <pre id="resp-liked-blogs">Waiting...</pre>
          </div>
        </div>

        <div class="card">
          <h2>Admin list users</h2>
          <p class="muted">GET /admin/users/list</p>
          <form id="admin-list-form">
            <label>
              Search
              <input
                id="admin-list-search"
                name="search"
                type="text"
                placeholder="email search"
              />
            </label>
            <label>
              Status
              <select id="admin-list-status" name="status">
                <option value="">all</option>
                <option value="active">active</option>
                <option value="deactive">deactive</option>
                <option value="banned">banned</option>
              </select>
            </label>
            <label>
              Sort By
              <select id="admin-list-sort-by" name="sortBy">
                <option value="createdAt" selected>createdAt</option>
                <option value="updatedAt">updatedAt</option>
                <option value="email">email</option>
                <option value="role">role</option>
                <option value="status">status</option>
              </select>
            </label>
            <label>
              Sort Order
              <select id="admin-list-sort-order" name="sortOrder">
                <option value="desc" selected>desc</option>
                <option value="asc">asc</option>
              </select>
            </label>
            <label>
              Page
              <input
                id="admin-list-page"
                name="page"
                type="number"
                min="1"
                value="1"
              />
            </label>
            <label>
              Limit
              <input
                id="admin-list-limit"
                name="limit"
                type="number"
                min="1"
                value="10"
              />
            </label>
            <button type="submit">List users</button>
          </form>
          <div class="panel">
            <div class="muted">Curl</div>
            <pre id="curl-admin-list"></pre>
          </div>
          <div class="panel">
            <div class="muted">Response</div>
            <pre id="resp-admin-list">Waiting...</pre>
          </div>
        </div>

        <div class="card">
          <h2>Admin update user status</h2>
          <p class="muted">PATCH /admin/users/update</p>
          <form id="admin-update-form">
            <label>
              User Id
              <input
                id="admin-update-user-id"
                name="userId"
                type="text"
                placeholder="user ObjectId"
                required
              />
            </label>
            <label>
              Status
              <select id="admin-update-status" name="status" required>
                <option value="active">active</option>
                <option value="deactive">deactive</option>
                <option value="banned">banned</option>
              </select>
            </label>
            <button type="submit">Update status</button>
          </form>
          <div class="panel">
            <div class="muted">Curl</div>
            <pre id="curl-admin-update"></pre>
          </div>
          <div class="panel">
            <div class="muted">Response</div>
            <pre id="resp-admin-update">Waiting...</pre>
          </div>
        </div>
      </div>
    </section>

    <script>
      const baseUrlInput = document.getElementById("base-url");
      const tokenInput = document.getElementById("token");
      const getBtn = document.getElementById("get-profile");
      const curlGetEl = document.getElementById("curl-get");
      const respGetEl = document.getElementById("resp-get");

      const updateForm = document.getElementById("update-form");
      const nameInput = document.getElementById("name");
      const bioInput = document.getElementById("bio");
      const curlUpdateEl = document.getElementById("curl-update");
      const respUpdateEl = document.getElementById("resp-update");

      const artistCreateForm = document.getElementById("artist-create-form");
      const artistCreateDisplayNameInput =
        document.getElementById("artist-display-name");
      const artistCreateTechniquesInput =
        document.getElementById("artist-techniques");
      const artistCreateStylesInput =
        document.getElementById("artist-styles");
      const curlArtistCreateEl = document.getElementById("curl-artist-create");
      const respArtistCreateEl = document.getElementById("resp-artist-create");

      const artistUpdateForm = document.getElementById("artist-update-form");
      const artistUpdateDisplayNameInput = document.getElementById(
        "artist-update-display-name"
      );
      const artistUpdateTechniquesInput = document.getElementById(
        "artist-update-techniques"
      );
      const artistUpdateStylesInput =
        document.getElementById("artist-update-styles");
      const curlArtistUpdateEl = document.getElementById("curl-artist-update");
      const respArtistUpdateEl = document.getElementById("resp-artist-update");

      const adminListForm = document.getElementById("admin-list-form");
      const curlAdminListEl = document.getElementById("curl-admin-list");
      const respAdminListEl = document.getElementById("resp-admin-list");

      const adminUpdateForm = document.getElementById("admin-update-form");
      const curlAdminUpdateEl = document.getElementById("curl-admin-update");
      const respAdminUpdateEl = document.getElementById("resp-admin-update");

      const savedArtworkIdInput = document.getElementById("saved-artwork-id");
      const savedBlogIdInput = document.getElementById("saved-blog-id");
      const likedArtworkIdInput = document.getElementById("liked-artwork-id");
      const likedBlogIdInput = document.getElementById("liked-blog-id");
      const respSavedArtworks = document.getElementById("resp-saved-artworks");
      const respSavedBlogs = document.getElementById("resp-saved-blogs");
      const respLikedArtworks = document.getElementById("resp-liked-artworks");
      const respLikedBlogs = document.getElementById("resp-liked-blogs");

      const cleanBase = () => baseUrlInput.value.replace(/\/+$/, "");

      const parseList = (value) =>
        (value || "")
          .split(",")
          .map((v) => v.trim())
          .filter(Boolean);

      const sendProfileRequest = async (method, path, body, responseEl) => {
        responseEl.textContent = "Loading...";
        try {
          const res = await fetch(`${cleanBase()}${path}`, {
            method,
            headers: {
              ...(body ? { "Content-Type": "application/json" } : {}),
              Authorization: `Bearer ${tokenInput.value}`,
            },
            body: body ? JSON.stringify(body) : undefined,
          });
          const text = await res.text();
          let data;
          try {
            data = JSON.parse(text);
          } catch (err) {
            throw new Error(`Unexpected JSON response: ${text}`);
          }
          if (!res.ok) {
            throw new Error(data?.message || res.statusText);
          }
          responseEl.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          responseEl.textContent = `Error: ${err.message}`;
        }
      };

      const renderCurlGet = () => {
        const base = cleanBase();
        const token = tokenInput.value || "<TOKEN>";
        curlGetEl.textContent = [
          "curl",
          "-X GET",
          `"${base}/users/profile/get"`,
          '-H "Authorization: Bearer ' + token + '"',
        ].join(" ");
      };

      const renderCurlUpdate = () => {
        const base = cleanBase();
        const token = tokenInput.value || "<TOKEN>";
        const body = {
          name: nameInput.value || "Jane Doe",
          bio: bioInput.value || "",
        };
        curlUpdateEl.textContent = [
          "curl",
          "-X PATCH",
          `"${base}/users/profile/update"`,
          '-H "Authorization: Bearer ' + token + '"',
          '-H "Content-Type: application/json"',
          `-d '${JSON.stringify(body)}'`,
        ].join(" ");
      };

      const renderCurlArtistCreate = () => {
        const base = cleanBase();
        const token = tokenInput.value || "<TOKEN>";
        const body = {};

        if (artistCreateDisplayNameInput.value.trim()) {
          body.displayName = artistCreateDisplayNameInput.value.trim();
        }
        const techniques = parseList(artistCreateTechniquesInput.value);
        if (techniques.length) {
          body.techniques = techniques;
        }
        const styles = parseList(artistCreateStylesInput.value);
        if (styles.length) {
          body.styles = styles;
        }

        curlArtistCreateEl.textContent = [
          "curl",
          "-X POST",
          `"${base}/artists/create"`,
          '-H "Authorization: Bearer ' + token + '"',
          '-H "Content-Type: application/json"',
          `-d '${JSON.stringify(body)}'`,
        ].join(" ");
      };

      const renderCurlArtistUpdate = () => {
        const base = cleanBase();
        const token = tokenInput.value || "<TOKEN>";
        const body = {};

        if (artistUpdateDisplayNameInput.value.trim()) {
          body.displayName = artistUpdateDisplayNameInput.value.trim();
        }
        const techniques = parseList(artistUpdateTechniquesInput.value);
        if (techniques.length) {
          body.techniques = techniques;
        }
        const styles = parseList(artistUpdateStylesInput.value);
        if (styles.length) {
          body.styles = styles;
        }

        curlArtistUpdateEl.textContent = [
          "curl",
          "-X PATCH",
          `"${base}/artists/update"`,
          '-H "Authorization: Bearer ' + token + '"',
          '-H "Content-Type: application/json"',
          `-d '${JSON.stringify(body)}'`,
        ].join(" ");
      };

      const renderCurlAdminList = () => {
        const base = cleanBase();
        const token = tokenInput.value || "<TOKEN>";
        const params = new URLSearchParams();
        const form = new FormData(adminListForm);
        for (const [key, value] of form.entries()) {
          if (value) params.append(key, value.toString());
        }
        const query = params.toString();
        curlAdminListEl.textContent = [
          "curl",
          "-X GET",
          `"${base}/admin/users/list${query ? `?${query}` : ""}"`,
          '-H "Authorization: Bearer ' + token + '"',
        ].join(" ");
      };

      const renderCurlAdminUpdate = () => {
        const base = cleanBase();
        const token = tokenInput.value || "<TOKEN>";
        const form = new FormData(adminUpdateForm);
        const body = {
          userId: (form.get("userId") || "<USER_ID>").toString().trim(),
          status: (form.get("status") || "active").toString(),
        };
        curlAdminUpdateEl.textContent = [
          "curl",
          "-X PATCH",
          `"${base}/admin/users/update"`,
          '-H "Authorization: Bearer ' + token + '"',
          '-H "Content-Type: application/json"',
          `-d '${JSON.stringify(body)}'`,
        ].join(" ");
      };

      baseUrlInput.addEventListener("input", () => {
        renderCurlGet();
        renderCurlUpdate();
        renderCurlArtistCreate();
        renderCurlArtistUpdate();
        renderCurlAdminList();
        renderCurlAdminUpdate();
      });
      tokenInput.addEventListener("input", () => {
        renderCurlGet();
        renderCurlUpdate();
        renderCurlArtistCreate();
        renderCurlArtistUpdate();
        renderCurlAdminList();
        renderCurlAdminUpdate();
      });
      updateForm.addEventListener("input", renderCurlUpdate);
      artistCreateForm.addEventListener("input", renderCurlArtistCreate);
      artistUpdateForm.addEventListener("input", renderCurlArtistUpdate);
      adminListForm.addEventListener("input", renderCurlAdminList);
      adminUpdateForm.addEventListener("input", renderCurlAdminUpdate);

      renderCurlGet();
      renderCurlUpdate();
      renderCurlArtistCreate();
      renderCurlArtistUpdate();
      renderCurlAdminList();
      renderCurlAdminUpdate();

      getBtn.addEventListener("click", async () => {
        respGetEl.textContent = "Fetching profile...";
        try {
          const res = await fetch(`${cleanBase()}/users/profile/get`, {
            headers: {
              Authorization: `Bearer ${tokenInput.value}`,
            },
          });
          const text = await res.text();
          let data;
          try {
            data = JSON.parse(text);
          } catch (err) {
            throw new Error(`Unexpected JSON response: ${text}`);
          }
          if (!res.ok) {
            throw new Error(data?.message || res.statusText);
          }
          respGetEl.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          respGetEl.textContent = `Error: ${err.message}`;
        }
      });

      updateForm.addEventListener("submit", async (event) => {
        event.preventDefault();
        respUpdateEl.textContent = "Updating profile...";
        const payload = {
          name: !!nameInput.value ? nameInput.value : undefined,
          bio: !!bioInput.value ? bioInput.value : undefined,
        };
        try {
          const res = await fetch(`${cleanBase()}/users/profile/update`, {
            method: "PATCH",
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${tokenInput.value}`,
            },
            body: JSON.stringify(payload),
          });
          const text = await res.text();
          let data;
          try {
            data = JSON.parse(text);
          } catch (err) {
            throw new Error(`Unexpected JSON response: ${text}`);
          }
          if (!res.ok) {
            throw new Error(data?.message || res.statusText);
          }
          respUpdateEl.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          respUpdateEl.textContent = `Error: ${err.message}`;
        }
      });

      artistCreateForm.addEventListener("submit", async (event) => {
        event.preventDefault();
        respArtistCreateEl.textContent = "Creating artist profile...";
        const payload = {};

        if (artistCreateDisplayNameInput.value.trim()) {
          payload.displayName = artistCreateDisplayNameInput.value.trim();
        }
        const techniques = parseList(artistCreateTechniquesInput.value);
        if (techniques.length) {
          payload.techniques = techniques;
        }
        const styles = parseList(artistCreateStylesInput.value);
        if (styles.length) {
          payload.styles = styles;
        }

        try {
          const res = await fetch(`${cleanBase()}/artists/create`, {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${tokenInput.value}`,
            },
            body: JSON.stringify(payload),
          });
          const text = await res.text();
          let data;
          try {
            data = JSON.parse(text);
          } catch (err) {
            throw new Error(`Unexpected JSON response: ${text}`);
          }
          if (!res.ok) {
            throw new Error(data?.message || res.statusText);
          }
          respArtistCreateEl.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          respArtistCreateEl.textContent = `Error: ${err.message}`;
        }
      });

      artistUpdateForm.addEventListener("submit", async (event) => {
        event.preventDefault();
        respArtistUpdateEl.textContent = "Updating artist profile...";
        const payload = {};

        if (artistUpdateDisplayNameInput.value.trim()) {
          payload.displayName = artistUpdateDisplayNameInput.value.trim();
        }
        const techniques = parseList(artistUpdateTechniquesInput.value);
        if (techniques.length) {
          payload.techniques = techniques;
        }
        const styles = parseList(artistUpdateStylesInput.value);
        if (styles.length) {
          payload.styles = styles;
        }

        try {
          const res = await fetch(`${cleanBase()}/artists/update`, {
            method: "PATCH",
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${tokenInput.value}`,
            },
            body: JSON.stringify(payload),
          });
          const text = await res.text();
          let data;
          try {
            data = JSON.parse(text);
          } catch (err) {
            throw new Error(`Unexpected JSON response: ${text}`);
          }
          if (!res.ok) {
            throw new Error(data?.message || res.statusText);
          }
          respArtistUpdateEl.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          respArtistUpdateEl.textContent = `Error: ${err.message}`;
        }
      });

      adminListForm.addEventListener("submit", async (event) => {
        event.preventDefault();
        respAdminListEl.textContent = "Loading users...";
        const params = new URLSearchParams();
        const form = new FormData(adminListForm);
        for (const [key, value] of form.entries()) {
          if (value) params.append(key, value.toString());
        }
        const query = params.toString();
        try {
          const res = await fetch(
            `${cleanBase()}/admin/users/list${query ? `?${query}` : ""}`,
            {
              headers: {
                Authorization: `Bearer ${tokenInput.value}`,
              },
            }
          );
          const text = await res.text();
          let data;
          try {
            data = JSON.parse(text);
          } catch (err) {
            throw new Error(`Unexpected JSON response: ${text}`);
          }
          if (!res.ok) {
            throw new Error(data?.message || res.statusText);
          }
          respAdminListEl.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          respAdminListEl.textContent = `Error: ${err.message}`;
        }
      });

      adminUpdateForm.addEventListener("submit", async (event) => {
        event.preventDefault();
        respAdminUpdateEl.textContent = "Updating user status...";
        const form = new FormData(adminUpdateForm);
        const payload = {
          userId: (form.get("userId") || "").toString().trim(),
          status: form.get("status"),
        };
        try {
          const res = await fetch(`${cleanBase()}/admin/users/update`, {
            method: "PATCH",
            headers: {
              "Content-Type": "application/json",
              Authorization: `Bearer ${tokenInput.value}`,
            },
            body: JSON.stringify(payload),
          });
          const text = await res.text();
          let data;
          try {
            data = JSON.parse(text);
          } catch (err) {
            throw new Error(`Unexpected JSON response: ${text}`);
          }
          if (!res.ok) {
            throw new Error(data?.message || res.statusText);
          }
          respAdminUpdateEl.textContent = JSON.stringify(data, null, 2);
        } catch (err) {
          respAdminUpdateEl.textContent = `Error: ${err.message}`;
        }
      });

      document
        .getElementById("save-artwork-btn")
        .addEventListener("click", () => {
          const artworkId = savedArtworkIdInput.value.trim();
          sendProfileRequest(
            "POST",
            "/users/profile/saved/artworks",
            { artworkId },
            respSavedArtworks
          );
        });

      document
        .getElementById("unsave-artwork-btn")
        .addEventListener("click", () => {
          const artworkId = savedArtworkIdInput.value.trim();
          sendProfileRequest(
            "DELETE",
            "/users/profile/saved/artworks",
            { artworkId },
            respSavedArtworks
          );
        });

      document
        .getElementById("list-saved-artworks-btn")
        .addEventListener("click", () => {
          sendProfileRequest(
            "GET",
            "/users/profile/saved/artworks",
            null,
            respSavedArtworks
          );
        });

      document
        .getElementById("save-blog-btn")
        .addEventListener("click", () => {
          const blogId = savedBlogIdInput.value.trim();
          sendProfileRequest(
            "POST",
            "/users/profile/saved/blogs",
            { blogId },
            respSavedBlogs
          );
        });

      document
        .getElementById("unsave-blog-btn")
        .addEventListener("click", () => {
          const blogId = savedBlogIdInput.value.trim();
          sendProfileRequest(
            "DELETE",
            "/users/profile/saved/blogs",
            { blogId },
            respSavedBlogs
          );
        });

      document
        .getElementById("list-saved-blogs-btn")
        .addEventListener("click", () => {
          sendProfileRequest(
            "GET",
            "/users/profile/saved/blogs",
            null,
            respSavedBlogs
          );
        });

      document
        .getElementById("like-artwork-btn")
        .addEventListener("click", () => {
          const artworkId = likedArtworkIdInput.value.trim();
          sendProfileRequest(
            "POST",
            "/users/profile/liked/artworks",
            { artworkId },
            respLikedArtworks
          );
        });

      document
        .getElementById("unlike-artwork-btn")
        .addEventListener("click", () => {
          const artworkId = likedArtworkIdInput.value.trim();
          sendProfileRequest(
            "DELETE",
            "/users/profile/liked/artworks",
            { artworkId },
            respLikedArtworks
          );
        });

      document
        .getElementById("list-liked-artworks-btn")
        .addEventListener("click", () => {
          sendProfileRequest(
            "GET",
            "/users/profile/liked/artworks",
            null,
            respLikedArtworks
          );
        });

      document
        .getElementById("like-blog-btn")
        .addEventListener("click", () => {
          const blogId = likedBlogIdInput.value.trim();
          sendProfileRequest(
            "POST",
            "/users/profile/liked/blogs",
            { blogId },
            respLikedBlogs
          );
        });

      document
        .getElementById("unlike-blog-btn")
        .addEventListener("click", () => {
          const blogId = likedBlogIdInput.value.trim();
          sendProfileRequest(
            "DELETE",
            "/users/profile/liked/blogs",
            { blogId },
            respLikedBlogs
          );
        });

      document
        .getElementById("list-liked-blogs-btn")
        .addEventListener("click", () => {
          sendProfileRequest(
            "GET",
            "/users/profile/liked/blogs",
            null,
            respLikedBlogs
          );
        });
    </script>
  </body>
</html>
